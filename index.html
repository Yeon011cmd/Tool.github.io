<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>적정 주가 계산기</title>
<style>
body {
    font-family: Arial;
    max-width: 720px;
    margin: 40px auto;
    padding: 20px;
}
h2 {
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
}
input, select {
    width: 100%;
    padding: 8px;
    margin: 5px 0 15px 0;
}
button {
    padding: 10px;
    width: 100%;
    margin-bottom: 10px;
    cursor: pointer;
}
.result {
    margin-top: 10px;
    font-weight: bold;
}
.note {
    margin-top: 40px;
    font-size: 13px;
    color: gray;
}
</style>
</head>
<body>

<h1>주식 적정가 계산기</h1>

<label>통화 선택</label>
<select id="currency">
    <option value="원">원 (₩)</option>
    <option value="달러">달러 ($)</option>
</select>

<h2>1. PER 기반 적정주가</h2>
<label>EPS (주당순이익)</label>
<input type="number" id="eps">

<label>목표 PER</label>
<input type="number" id="per">

<button onclick="calculatePER()">적정주가 계산</button>
<div class="result" id="perResult"></div>


<h2>2. PEG 계산 (과열 판단)</h2>
<label>현재 PER</label>
<input type="number" id="currentPER">

<label>예상 성장률 (%)</label>
<input type="number" id="growthRate">

<button onclick="calculatePEG()">PEG 계산</button>
<div class="result" id="pegResult"></div>
<div>
PEG 1 이하 → 저평가 가능성<br>
PEG 1~2 → 합리적<br>
PEG 2 초과 → 과열 가능성
</div>


<h2>3. 현재가 비교 및 안전마진</h2>
<label>현재 주가</label>
<input type="number" id="currentPrice">

<label>안전마진 (%)</label>
<input type="number" id="margin" placeholder="예: 20">

<button onclick="calculateMargin()">비교 및 매수가 계산</button>
<div class="result" id="marginResult"></div>


<h2>4. 3년 기대수익률 계산</h2>
<label>예상 연 성장률 (%)</label>
<input type="number" id="annualGrowth">

<button onclick="calculateReturn()">3년 기대수익률 계산</button>
<div class="result" id="returnResult"></div>


<div class="note">
본 계산기는 선택한 통화 기준으로 계산됩니다.
</div>


<script>
let fairPrice = 0;

function getCurrency() {
    return document.getElementById("currency").value === "원" ? "원" : "달러";
}

function calculatePER() {
    const eps = parseFloat(document.getElementById("eps").value);
    const per = parseFloat(document.getElementById("per").value);

    if (isNaN(eps) || isNaN(per)) {
        alert("EPS와 PER을 입력하세요");
        return;
    }

    fairPrice = eps * per;
    document.getElementById("perResult").innerHTML =
        "적정주가: " + fairPrice.toLocaleString() + " " + getCurrency();
}

function calculatePEG() {
    const per = parseFloat(document.getElementById("currentPER").value);
    const growth = parseFloat(document.getElementById("growthRate").value);

    if (isNaN(per) || isNaN(growth) || growth === 0) {
        alert("PER과 성장률을 입력하세요");
        return;
    }

    const peg = per / growth;

    document.getElementById("pegResult").innerHTML =
        "PEG 값: " + peg.toFixed(2);
}

function calculateMargin() {
    const currentPrice = parseFloat(document.getElementById("currentPrice").value);
    const margin = parseFloat(document.getElementById("margin").value);

    if (fairPrice === 0) {
        alert("먼저 적정주가를 계산하세요");
        return;
    }

    if (isNaN(currentPrice) || isNaN(margin)) {
        alert("현재가와 안전마진을 입력하세요");
        return;
    }

    const gap = ((fairPrice - currentPrice) / currentPrice) * 100;
    const buyPrice = fairPrice * (1 - margin / 100);

    document.getElementById("marginResult").innerHTML =
        "적정가 대비 괴리율: " + gap.toFixed(2) + "%<br>" +
        "안전마진 적용 매수가: " + buyPrice.toLocaleString() + " " + getCurrency();
}

function calculateReturn() {
    const annualGrowth = parseFloat(document.getElementById("annualGrowth").value);
    const currentPrice = parseFloat(document.getElementById("currentPrice").value);

    if (isNaN(annualGrowth) || isNaN(currentPrice) || fairPrice === 0) {
        alert("성장률과 현재가를 입력하고 적정주가를 계산하세요");
        return;
    }

    const futurePrice = currentPrice * Math.pow((1 + annualGrowth / 100), 3);
    const totalReturn = ((futurePrice - currentPrice) / currentPrice) * 100;

    document.getElementById("returnResult").innerHTML =
        "3년 후 예상 주가: " + futurePrice.toLocaleString() + " " + getCurrency() +
        "<br>3년 기대수익률: " + totalReturn.toFixed(2) + "%";
}
</script>

</body>
</html>
